% This tutorial shows how to use the toolbox in a compact form that splits
% the process in three parts: data_generation, model initialization, model
% training and evaluation
clear

addpath aux_scripts
make_example_regression_data
model.type='regression';

% Uncomment the next two lines if you wish to run a classification tutorial
make_example_classification_data
model.type='classification';

example_model_initialization
model.optimizer='ADAM';
model=model_train(model);



[ ~,out]=forwardpassing(model,x); % The first output argument corresponds to the updated model but it is not needed here
%%
figure(1)
clf
hold
if strcmp(model.type,'regression')
    
    
    plot(x,y,'.')
    plot(x,out,'.')
else
    
    for xi=1:size(x,1)
        h=plot(x(xi,1),x(xi,2),'.');
        set(h,'MarkerSize',out(xi,1)*5+3,'Color',round(out(xi,1)*[1 0 0]));
    end
end

%% Visualize the network
figure(2)
clf
show_network(model)

